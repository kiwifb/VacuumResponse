!
!  Collection of routines for link multiplication
!
      MODULE GS_UU9

      CONTAINS

      subroutine UU(tor,toi,t1r,t1i,t2r,t2i)

      USE GS_LATTICESIZE

      implicit none
!
      integer,parameter                                           :: nc=3
!
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(inout) :: tor,toi
!HPF$ DISTRIBUTE tor(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE toi(*,*,BLOCK,BLOCK,*,*)
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(in)    :: t1r,t1i,t2r,t2i
!HPF$ DISTRIBUTE t1r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t1i(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2i(*,*,BLOCK,BLOCK,*,*)
!
!  Timer Support
!
!      INTEGER start_count, end_count, count_rate
!      REAL    elapsed_time
!
!  Useage
!
!  CALL SYSTEM_CLOCK(start_count, count_rate)
!  CALL SYSTEM_CLOCK(end_count)
!  elapsed_time = REAL(end_count - start_count) / REAL(count_rate)
!
!      CALL SYSTEM_CLOCK(start_count, count_rate)
!
!  ic=1  jc=1
!
      tor(:,:,:,:,1,1) = tor(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,3,1)
      toi(:,:,:,:,1,1) = toi(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,2) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,1,3) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,3,1)
!
!  ic=1  jc=2
!
      tor(:,:,:,:,1,2) = tor(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,3,2)
      toi(:,:,:,:,1,2) = toi(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,1) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,1,3) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,3,2)
!
!  ic=1  jc=3
!
      tor(:,:,:,:,1,3) = tor(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,1,3) = toi(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,1) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,2) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,1,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,3,3)
!
!  ic=2  jc=1
!
      tor(:,:,:,:,2,1) = tor(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,3,1)
      toi(:,:,:,:,2,1) = toi(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,2) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,3) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,3,1)
!
!  ic=2  jc=2
!
      tor(:,:,:,:,2,2) = tor(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,3,2)
      toi(:,:,:,:,2,2) = toi(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,1) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,2,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,3) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,3,2)
!
!  ic=2  jc=3
!
      tor(:,:,:,:,2,3) = tor(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,2,3) = toi(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,2,1) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,2,2) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,2,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,3,3)
!
!  ic=3  jc=1
!
      tor(:,:,:,:,3,1) = tor(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,3,1)
      toi(:,:,:,:,3,1) = toi(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,3,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,3,2) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,3,3) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,3,1)
!
!  ic=3  jc=2
!
      tor(:,:,:,:,3,2) = tor(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,3,2)
      toi(:,:,:,:,3,2) = toi(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,1) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,3) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,3,2)
!
!  ic=3  jc=3
!
      tor(:,:,:,:,3,3) = tor(:,:,:,:,3,3)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,3,3) = toi(:,:,:,:,3,3)
     &  + t1r(:,:,:,:,3,1) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,3,2) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,3,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,3,3)
!
!      CALL SYSTEM_CLOCK(end_count)
!      elapsed_time = REAL(end_count - start_count) / REAL(count_rate)
!c
!!  Excluding assignments
!c
!      if (elapsed_time .ne. 0.0) then
!        write(*,'(/,a,f8.5,a)') 'The elapsed time is',elapsed_time,
!     &    ' seconds for one call to UU.'
!        write(*,'(a,f8.3,a)') 'The processing speed is',
!     &    216.0*nx*ny*nz*nt/elapsed_time/1.0e09,' GFLOPS.'
!      end if
!
      return
      end subroutine UU
c
c
c
      subroutine UUdag(tor,toi,t1r,t1i,t2r,t2i)

      USE GS_LATTICESIZE

      implicit none
c
      integer,parameter                                           :: nc=3
c
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(inout) :: tor,toi
!HPF$ DISTRIBUTE tor(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE toi(*,*,BLOCK,BLOCK,*,*)
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(in)    :: t1r,t1i,t2r,t2i
!HPF$ DISTRIBUTE t1r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t1i(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2i(*,*,BLOCK,BLOCK,*,*)
c
! i! = 1  j! = 1
c
      tor(:,:,:,:,1,1) = tor(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,1,1) + t1i(:,:,:,:,1,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,1,2) + t1i(:,:,:,:,1,2) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,1,3) + t1i(:,:,:,:,1,3) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,1,1) = toi(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,1,3)
c
! i! = 1  j! = 2
c
      tor(:,:,:,:,1,2) = tor(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,2,1) + t1i(:,:,:,:,1,1) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,2,2) + t1i(:,:,:,:,1,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,2,3) + t1i(:,:,:,:,1,3) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,1,2) = toi(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,2,3)
c
! i! = 1  j! = 3
c
      tor(:,:,:,:,1,3) = tor(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,3,1) + t1i(:,:,:,:,1,1) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,3,2) + t1i(:,:,:,:,1,2) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,3,3) + t1i(:,:,:,:,1,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,1,3) = toi(:,:,:,:,1,3)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,1,1) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,1,2) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,1,3) * t2r(:,:,:,:,3,3)
c
! i! = 2  j! = 1
c
      tor(:,:,:,:,2,1) = tor(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,1,1) + t1i(:,:,:,:,2,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,1,2) + t1i(:,:,:,:,2,2) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,1,3) + t1i(:,:,:,:,2,3) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,2,1) = toi(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,1,3)
c
! i! = 2  j! = 2
c
      tor(:,:,:,:,2,2) = tor(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,2,1) + t1i(:,:,:,:,2,1) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,2,2) + t1i(:,:,:,:,2,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,2,3) + t1i(:,:,:,:,2,3) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,2,2) = toi(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,2,3)
c
! i! = 2  j! = 3
c
      tor(:,:,:,:,2,3) = tor(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,3,1) + t1i(:,:,:,:,2,1) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,3,2) + t1i(:,:,:,:,2,2) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,3,3) + t1i(:,:,:,:,2,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,2,3) = toi(:,:,:,:,2,3)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,2,1) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,2,2) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,2,3) * t2r(:,:,:,:,3,3)
c
! i! = 3  j! = 1
c
      tor(:,:,:,:,3,1) = tor(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,1,1) + t1i(:,:,:,:,3,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,1,2) + t1i(:,:,:,:,3,2) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,1,3) + t1i(:,:,:,:,3,3) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,3,1) = toi(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,1,1) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,1,2) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,1,3) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,1,3)
c
! i! = 3  j! = 2
c
      tor(:,:,:,:,3,2) = tor(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,2,1) + t1i(:,:,:,:,3,1) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,2,2) + t1i(:,:,:,:,3,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,2,3) + t1i(:,:,:,:,3,3) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,3,2) = toi(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,2,1) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,2,2) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,2,3) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,2,3)
c
! i! = 3  j! = 3
c
      tor(:,:,:,:,3,3) = tor(:,:,:,:,3,3)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,3,1) + t1i(:,:,:,:,3,1) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,3,2) + t1i(:,:,:,:,3,2) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,3,3) + t1i(:,:,:,:,3,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,3,3) = toi(:,:,:,:,3,3)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,3,1) + t1i(:,:,:,:,3,1) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,3,2) + t1i(:,:,:,:,3,2) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,3,3) + t1i(:,:,:,:,3,3) * t2r(:,:,:,:,3,3)
c
      return
      end subroutine UUdag
c
c
c
      subroutine UdagUdag(tor,toi,t1r,t1i,t2r,t2i)

      USE GS_LATTICESIZE

      implicit none
c
      integer,parameter                                           :: nc=3
c
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(inout) :: tor,toi
!HPF$ DISTRIBUTE tor(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE toi(*,*,BLOCK,BLOCK,*,*)
      double precision,dimension(nx,ny,nz,nt,nc,nc),intent(in)    :: t1r,t1i,t2r,t2i
!HPF$ DISTRIBUTE t1r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t1i(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2r(*,*,BLOCK,BLOCK,*,*)
!HPF$ DISTRIBUTE t2i(*,*,BLOCK,BLOCK,*,*)
c
! i! = 1  j! = 1
c
      tor(:,:,:,:,1,1) = tor(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,1,1) = toi(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,1,1) - t1i(:,:,:,:,1,1) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,1,2) - t1i(:,:,:,:,2,1) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,1,3) - t1i(:,:,:,:,3,1) * t2r(:,:,:,:,1,3)
c
! i! = 1  j! = 2
c
      tor(:,:,:,:,1,2) = tor(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,1,2) = toi(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,2,1) - t1i(:,:,:,:,1,1) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,2,2) - t1i(:,:,:,:,2,1) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,2,3) - t1i(:,:,:,:,3,1) * t2r(:,:,:,:,2,3)
c
! i! = 1  j! = 3
c
      tor(:,:,:,:,1,3) = tor(:,:,:,:,1,3)
     &  + t1r(:,:,:,:,1,1) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,1,1) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,2,1) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,2,1) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,1) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,3,1) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,1,3) = toi(:,:,:,:,1,3)
     &  - t1r(:,:,:,:,1,1) * t2i(:,:,:,:,3,1) - t1i(:,:,:,:,1,1) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,2,1) * t2i(:,:,:,:,3,2) - t1i(:,:,:,:,2,1) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,3,1) * t2i(:,:,:,:,3,3) - t1i(:,:,:,:,3,1) * t2r(:,:,:,:,3,3)
c
! i! = 2  j! = 1
c
      tor(:,:,:,:,2,1) = tor(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,2,1) = toi(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,1,1) - t1i(:,:,:,:,1,2) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,1,2) - t1i(:,:,:,:,2,2) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,1,3) - t1i(:,:,:,:,3,2) * t2r(:,:,:,:,1,3)
c
! i! = 2  j! = 2
c
      tor(:,:,:,:,2,2) = tor(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,2,2) = toi(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,2,1) - t1i(:,:,:,:,1,2) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,2,2) - t1i(:,:,:,:,2,2) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,2,3) - t1i(:,:,:,:,3,2) * t2r(:,:,:,:,2,3)
c
! i! = 2  j! = 3
c
      tor(:,:,:,:,2,3) = tor(:,:,:,:,2,3)
     &  + t1r(:,:,:,:,1,2) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,1,2) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,2,2) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,2,2) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,2) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,3,2) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,2,3) = toi(:,:,:,:,2,3)
     &  - t1r(:,:,:,:,1,2) * t2i(:,:,:,:,3,1) - t1i(:,:,:,:,1,2) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,2,2) * t2i(:,:,:,:,3,2) - t1i(:,:,:,:,2,2) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,3,2) * t2i(:,:,:,:,3,3) - t1i(:,:,:,:,3,2) * t2r(:,:,:,:,3,3)
c
! i! = 3  j! = 1
c
      tor(:,:,:,:,3,1) = tor(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,1,1) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,1,1)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,1,2) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,1,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,1,3) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,1,3)
      toi(:,:,:,:,3,1) = toi(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,1,1) - t1i(:,:,:,:,1,3) * t2r(:,:,:,:,1,1)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,1,2) - t1i(:,:,:,:,2,3) * t2r(:,:,:,:,1,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,1,3) - t1i(:,:,:,:,3,3) * t2r(:,:,:,:,1,3)
c
! i! = 3  j! = 2
c
      tor(:,:,:,:,3,2) = tor(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,2,1) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,2,1)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,2,2) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,2,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,2,3) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,2,3)
      toi(:,:,:,:,3,2) = toi(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,2,1) - t1i(:,:,:,:,1,3) * t2r(:,:,:,:,2,1)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,2,2) - t1i(:,:,:,:,2,3) * t2r(:,:,:,:,2,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,2,3) - t1i(:,:,:,:,3,3) * t2r(:,:,:,:,2,3)
c
! i! = 3  j! = 3
c
      tor(:,:,:,:,3,3) = tor(:,:,:,:,3,3)
     &  + t1r(:,:,:,:,1,3) * t2r(:,:,:,:,3,1) - t1i(:,:,:,:,1,3) * t2i(:,:,:,:,3,1)
     &  + t1r(:,:,:,:,2,3) * t2r(:,:,:,:,3,2) - t1i(:,:,:,:,2,3) * t2i(:,:,:,:,3,2)
     &  + t1r(:,:,:,:,3,3) * t2r(:,:,:,:,3,3) - t1i(:,:,:,:,3,3) * t2i(:,:,:,:,3,3)
      toi(:,:,:,:,3,3) = toi(:,:,:,:,3,3)
     &  - t1r(:,:,:,:,1,3) * t2i(:,:,:,:,3,1) - t1i(:,:,:,:,1,3) * t2r(:,:,:,:,3,1)
     &  - t1r(:,:,:,:,2,3) * t2i(:,:,:,:,3,2) - t1i(:,:,:,:,2,3) * t2r(:,:,:,:,3,2)
     &  - t1r(:,:,:,:,3,3) * t2i(:,:,:,:,3,3) - t1i(:,:,:,:,3,3) * t2r(:,:,:,:,3,3)
c
      return
      end subroutine UdagUdag

      END MODULE GS_UU9
